!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("android-remote-control-vue",[],t):"object"==typeof exports?exports["android-remote-control-vue"]=t():e["android-remote-control-vue"]=t()}(self,(function(){return(()=>{"use strict";var e={647:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(645),i=n.n(o)()((function(e){return e[1]}));i.push([e.id,".android-remote-control[data-v-76d8050e]{display:flex}.portrait[data-v-76d8050e]{width:100%;display:flex;flex-direction:row;align-items:stretch}.portrait .canvas-wapper[data-v-76d8050e]{flex:initial !important;flex-shrink:1}.portrait .controls-wapper[data-v-76d8050e]{flex:1}.horizontal[data-v-76d8050e]{display:flex;flex-direction:column;align-items:stretch}.horizontal .canvas-wapper[data-v-76d8050e]{flex:initial !important;flex-shrink:1}.horizontal .controls-wapper[data-v-76d8050e]{flex:1}.canvas-wapper .canvas[data-v-76d8050e]{border:1px solid black}.controls-wapper[data-v-76d8050e]{border:1px solid black}.controls-wapper .control[data-v-76d8050e]{display:flex;border:1px solid black}.off[data-v-76d8050e]{background-color:red}\n",""]);const s=i},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,o){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(o)for(var s=0;s<this.length;s++){var a=this[s][0];null!=a&&(i[a]=!0)}for(var r=0;r<e.length;r++){var l=[].concat(e[r]);o&&i[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),t.push(l))}},t}},379:(e,t,n)=>{var o,i=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),s=[];function a(e){for(var t=-1,n=0;n<s.length;n++)if(s[n].identifier===e){t=n;break}return t}function r(e,t){for(var n={},o=[],i=0;i<e.length;i++){var r=e[i],l=t.base?r[0]+t.base:r[0],c=n[l]||0,d="".concat(l," ").concat(c);n[l]=c+1;var h=a(d),u={css:r[1],media:r[2],sourceMap:r[3]};-1!==h?(s[h].references++,s[h].updater(u)):s.push({identifier:d,updater:f(u,t),references:1}),o.push(d)}return o}function l(e){var t=document.createElement("style"),o=e.attributes||{};if(void 0===o.nonce){var s=n.nc;s&&(o.nonce=s)}if(Object.keys(o).forEach((function(e){t.setAttribute(e,o[e])})),"function"==typeof e.insert)e.insert(t);else{var a=i(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var c,d=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function h(e,t,n,o){var i=n?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(e.styleSheet)e.styleSheet.cssText=d(t,i);else{var s=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(s,a[t]):e.appendChild(s)}}function u(e,t,n){var o=n.css,i=n.media,s=n.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),s&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleSheet)e.styleSheet.cssText=o;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(o))}}var p=null,v=0;function f(e,t){var n,o,i;if(t.singleton){var s=v++;n=p||(p=l(t)),o=h.bind(null,n,s,!1),i=h.bind(null,n,s,!0)}else n=l(t),o=u.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o));var n=r(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var o=0;o<n.length;o++){var i=a(n[o]);s[i].references--}for(var l=r(e,t),c=0;c<n.length;c++){var d=a(n[c]);0===s[d].references&&(s[d].updater(),s.splice(d,1))}n=l}}}}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var s=t[o]={id:o,exports:{}};return e[o](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var o={};return(()=>{n.d(o,{default:()=>l});const e={name:"android-remote-control",props:{host:"",showControls:!1},data:()=>({debug:!1,context:null,ws:null,isRotate:!1,canvas:null,txtClip:"",txtClipAllowUpdate:!0,portList:"",portNum:"19000,19001,7007",minicapOn:!1,maxWidth:0,maxHeight:0}),mounted(){this.init()},beforeDestroy(){},computed:{},methods:{handleMouseDown(e){this.canvas.mousedown||(this.canvas.mousedown=!0,this.mouseHandler("d",e),e.preventDefault(),this.canvas.focus())},handleMouseMove(e){this.canvas.mousedown&&(this.canvas.debounce||(this.canvas.debounce++,this.mouseHandler("m",e),setTimeout((()=>{this.canvas.debounce=0}),100)))},handleMouseUp(e){this.canvas.mousedown&&(this.canvas.mousedown=!1,this.mouseHandler("u",e),e.preventDefault())},handleKeyDown(e){this.keyHandler(e,!0),e.preventDefault()},handleKeyUp(e){this.keyHandler(e,!1),e.preventDefault()},init(){this.canvas=this.$refs.canvas,this.context=this.canvas.getContext("2d"),this.initCanvas(),this.createWs(),this.canvas.mousedown=!1,this.canvas.debounce=0},handleGetClip(e){this.txtClipAllowUpdate=!0,this.wsJson({event:"getclip"})},handleSetClip(e){this.wsJson({event:"setclip",text:this.txtClip})},handlePortList(){this.wsJson({event:"listports"})},handleFwdPort(){this.wsJson({event:"addport",rev:!1,port:this.portNum})},handleRevPort(){this.wsJson({event:"addport",rev:!0,port:this.portNum})},handleMinicap(){this.wsJson({event:"minicap"})},handleMinitouch(){this.wsJson({event:"minitouch"})},handlePower(){this.wsJson({event:"power"})},initCanvas(){let e=window.innerHeight,t=window.innerWidth;this.isRotate?(e=window.innerWidth-200,t=window.innerHeight-200):(e=window.innerHeight-200,t=window.innerWidth-200),this.maxHeight=`${e}px`,this.maxWidth=`${t}px`},setDebug(){this.debug=!this.debug,this.wsJson({event:"debug",val:this.debug})},wsOnMessage(e){if("string"==typeof e.data){let t=null;try{t=JSON.parse(e.data)}catch(e){}t&&("GetClipboardResponse"===t.type&&this.getClipResponse(t),"ports"===t.type&&this.getPortsResponse(t),"minicapStatus"===t.type&&(t.state||this.blankScreen(),console.log(e.data)),"minitouchStatus"===t.type&&(t.state||this.blankTouch(),console.log(e.data)))}else{var t=new Blob([e.data],{type:"image/jpeg"}),n=window.URL||window.webkitURL,o=new Image;o.onload=()=>{this.canvas.width=o.width,this.canvas.height=o.height,this.setRotate(o.width,o.height),this.context.drawImage(o,0,0),o.onload=null,o.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",o=null,i=null,t=null,this.initCanvas(),this.minicapOn=!0};var i=n.createObjectURL(t);o.src=i}},createWs(){this.ws=new WebSocket("ws://"+this.host,"minicap"),this.ws.binaryType="blob",this.ws.onclose=()=>{this.blankScreen(),console.log("ws close...try reopen in 2 seconds"),setTimeout(this.createWs,2e3)},this.ws.onopen=()=>{console.log("ws open")},this.ws.onerror=()=>{console.log("ws error",arguments)},this.ws.onmessage=this.wsOnMessage},wsJson(e){if(this.ws.readyState===this.ws.OPEN){var t=JSON.stringify(e);this.debug&&console.log(t),this.ws.send(t)}else console.log("websocket is closed")},blankScreen(){this.context.fillStyle="#a00",this.context.fillRect(0,0,this.canvas.width,this.canvas.height),this.minicapOn=!1},setRotate(e,t){this.isRotate=e/t>1},mouseHandler(e,t){var n=this.canvas.getBoundingClientRect(),o=(t.clientX||(t.touches[0]||t.changedTouches[0]||{}).clientX)-n.left,i=(t.clientY||(t.touches[0]||t.changedTouches[0]||{}).clientY)-n.top,s=o/this.canvas.scrollWidth,a=i/this.canvas.scrollHeight;if(this.isRotate){var r=s;s=1-a,a=r}this.wsJson({event:"mouse",t:e,x:s,y:a}),this.debug&&console.log(t.type,e,this.canvas.debounce,this.canvas.mousedown,o,i,this.canvas.scrollWidth,this.canvas.scrollHeight)},keyHandler(e,t){var n=e.getModifierState("CapsLock"),o={event:"key",key:e.keyCode,mods:[e.shiftKey,e.ctrlKey,e.altKey,e.metaKey,n],isDown:t};this.wsJson(o)},getClipResponse(e){this.txtClipAllowUpdate&&(this.txtClip=e.message.text,this.txtClipAllowUpdate=!1)},getPortsResponse(e){this.portList=e.data}}};var t=n(379),i=n.n(t),s=n(647);i()(s.Z,{insert:"head",singleton:!1}),s.Z.locals;const a=function(e,t,n,o,i,s,a,r){var l,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=[],c._compiled=!0),c._scopeId="data-v-76d8050e",l)if(c.functional){c._injectStyles=l;var d=c.render;c.render=function(e,t){return l.call(t),d(e,t)}}else{var h=c.beforeCreate;c.beforeCreate=h?[].concat(h,l):[l]}return{exports:e,options:c}}(e,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"android-remote-control"},[n("div",{class:{horizontal:e.isRotate,portrait:!e.isRotate}},[n("div",{staticClass:"canvas-wapper"},[n("canvas",{ref:"canvas",staticClass:"canvas",style:{maxHeight:e.maxHeight,maxWidth:e.maxWidth},attrs:{tabindex:"0"},on:{mouseup:e.handleMouseUp,touchend:e.handleMouseUp,mousedown:e.handleMouseDown,touchstart:e.handleMouseUp,mousemove:e.handleMouseMove,touchmove:e.handleMouseMove,keydown:e.handleKeyDown,keyup:e.handleKeyUp}})]),e._v(" "),e.showControls?n("div",{staticClass:"controls-wapper"},[n("div",{staticClass:"control"},[n("button",{ref:"power",attrs:{tabindex:"2"},on:{click:function(t){return e.handlePower()}}},[e._v("Power")]),e._v(" "),n("button",{ref:"get-clip",attrs:{tabindex:"3"},on:{click:function(t){return e.handleGetClip()}}},[e._v("Get Clipboard")]),e._v(" "),n("button",{ref:"set-clip",attrs:{tabindex:"4"},on:{click:function(t){return e.handleSetClip()}}},[e._v("Set Clipboard")])]),e._v(" "),n("div",{staticClass:"control"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.txtClip,expression:"txtClip"}],attrs:{cols:"24",rows:"3"},domProps:{value:e.txtClip},on:{input:function(t){t.target.composing||(e.txtClip=t.target.value)}}})]),e._v(" "),n("div",{staticClass:"control"},[n("button",{ref:"list-ports",attrs:{tabindex:"6"},on:{click:function(t){return e.handlePortList()}}},[e._v("Ports")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.portNum,expression:"portNum"}],staticStyle:{flex:"5"},attrs:{tabindex:"7",size:"1"},domProps:{value:e.portNum},on:{input:function(t){t.target.composing||(e.portNum=t.target.value)}}}),e._v(" "),n("button",{attrs:{tabindex:"8"},on:{click:function(t){return e.handleFwdPort()}}},[e._v("Fwd")]),e._v(" "),n("button",{attrs:{tabindex:"9"},on:{click:function(t){return e.handleRevPort()}}},[e._v("Rev")])]),e._v(" "),n("div",{staticStyle:{"white-space":"pre-wrap"}},[e._v(e._s(e.portList))]),e._v(" "),n("div",{staticClass:"control"},[n("button",{ref:"minicap",class:{off:!e.minicapOn},attrs:{tabindex:"10"},on:{click:function(t){return e.handleMinicap()}}},[e._v("Minicap")])])]):e._e()])])})).exports;function r(e){e.component(a.name,a)}window&&window.Vue&&Vue.use(r);const l=r})(),o.default})()}));